{
   "$schema" : "http://json-schema.org/draft-04/schema#",
   "description" : "This call manages two-factor account authentication",
   "type" : "object",
   "required" : [
      "account_security"
   ],
   "title" : "2-Factor Authentication Request",
   "additionalProperties" : false,
   "properties" : {
      "req_id" : {
         "type" : "integer",
         "description" : "Optional field to map request to response"
      },
      "totp_action" : {
         "enum" : [
            "status",
            "enable",
            "disable",
            "generate"
         ],
         "description" : "Action to be taken for managing TOTP (time-based one-time password, RFC6238). Generate will create a secret key which is then returned in the secret_key response field, you can then enable by using that code in a 2FA application."
      },
      "account_security" : {
         "enum" : [
            1
         ],
         "description" : "Must be 1",
         "type" : "integer"
      },
      "passthrough" : {
         "type" : "object",
         "description" : "Optional field, used to pass data through the websocket, which may be retrieved via the echo_req output field."
      },
      "otp" : {
         "pattern" : "^[0-9]{6}$",
         "description" : "OTP (one-time passcode) generated by a 2FA application like Authy, Google Authenticator or Yubikey.",
         "type" : "string"
      }
   }
}
